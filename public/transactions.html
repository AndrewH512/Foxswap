<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>View Transactions - Foxswap</title>
    <link rel="stylesheet" href="css/front-end.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />
</head>

<body>
    <header>
        <h1>View Transactions</h1>
        <a href="welcomepage.html">
            <img src="uploads/Fox_Swap_Logo.ico" alt="Logo" class="logo" style="width: 90px; height: 90px; position: absolute; top: 20px; left: 20px; z-index: 10;" />
        </a>
    </header>

    <nav id="navbar">
        <!-- Navigation links will be dynamically inserted here -->
    </nav>

    <main>
        <div class="main-content">
            <!-- Transaction data will be dynamically inserted here -->
        </div>
    </main>

    <div class="auth-buttons">
        <button class="admin-button" onclick="redirectTo('admin_home.html')">Go Back</button>
    </div>

    <div style="text-align: center; position: absolute; bottom: 0; width: 100%;">
        <div id="footer-placeholder"></div>
    </div>
    <script>
        // Function to fetch and display transactions
        function loadTransactions() {
            fetch('/api/viewTran', { method: 'GET' })
                .then(response => response.json())
                .then(data => {
                    const transactionsContainer = document.querySelector('.main-content');
                    if (data && data.length > 0) {
                        data.forEach(transaction => {
                            // Create a div for each transaction and add it to the container
                            const transactionDiv = document.createElement('div');
                            transactionDiv.classList.add('transaction-item');
                            transactionDiv.innerHTML = `
                            <h3>Transaction Number: ${transaction.Transaction_ID}</h3>
                            <p>This book "${transaction.Class_Name}" was sold by ${transaction.Seller} and bought by ${transaction.Buyer} for the price of $${transaction.Transaction_Price}.</p>
                            <p><strong>Post Status:</strong> ${transaction.Post_Status}</p>
                            <p><strong>Book Condition:</strong> ${transaction.Book_Condition}</p>
                            <p><strong>Transaction Type:</strong> ${transaction.Transaction_Type}</p>
                            <p><strong>Due Date:</strong> ${transaction.Due_Date || 'N/A'}</p>  <!-- Show N/A if no due date -->
                        `;
                        transactionsContainer.appendChild(transactionDiv);
                    });
                } else {
                    transactionsContainer.innerHTML = '<p>No transactions found.</p>';
                }
            })
            .catch(error => {
                console.error('Error fetching transactions:', error);
                const transactionsContainer = document.querySelector('.main-content');
                transactionsContainer.innerHTML = '<p>Error loading transactions. Please try again later.</p>';
            });
        }

        // Load transactions when the page is loaded
        window.onload = loadTransactions;
    </script>

    <!-- Important Scripts -->
    <script src="js/window.js"></script>
    <script src="js/sessionCheck.js"></script>
    <script src="js/profilePicture.js"></script>
    <script src="js/searchUsers.js"></script>
    <script src="js/buttons.js"></script>

</body>

</html>
